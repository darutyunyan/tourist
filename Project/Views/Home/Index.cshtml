@model Project.ModelView.IndexViewModel

@{
    Layout = "~/Views/Shared/BaseMaster.cshtml";
}

@section mainContent {
    @Html.Partial("Map")
    @Html.Partial("About")
    <div id="app">
        <div class="navbar navbar-inverse border-radius-none mb-0">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    @Html.ActionLink("Tourist", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a v-bind:class="{ active: selectedView == MAP_VIEW }" v-on:click="selectedView = MAP_VIEW" href="#">Home</a></li>
                        <li><a v-bind:class="{ active: selectedView == ABOUT_VIEW }" v-on:click="selectedView = ABOUT_VIEW" href="#">About</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                    <ul v-if="isAuthenticated" class="nav navbar-nav navbar-right">
                        <li class="pr-10 hidden-xs hidden-sm"><span class="email-style">@User.Identity.Name</span></li>
                        <li><a href="#"><span class="glyphicon glyphicon-cog"></span> Settings</a></li>
                        <li><a href="#"><span class="glyphicon glyphicon-user"></span> Log out</a></li>
                    </ul>

                    <ul v-else class="nav navbar-nav navbar-right">
                        <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                        <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                    </ul>

                    <form v-if="isAuthenticated" class="navbar-form navbar-right">
                        <select class="form-control">
                            @foreach (var city in Model.Cities)
                            {
                                <option>@city</option>
                            }
                        </select>
                    </form>
                </div>
            </div>
        </div>
        <div class="container-fluid pl-0 pr-0">
            <component v-bind:is="selectedView" v-bind="viewProps"></component>
        </div>
    </div>
}

@section scripts{
    <script type="text/javascript">
        var app = new Vue({
            el: '#app',
            components: {
                'map-view': mapView,
                'about-view': aboutView
            },
            data: {
                isAuthenticated: null,
                selectedView: null,
                viewProps: null,

                // constants
                MAP_VIEW: 'map-view',
                ABOUT_VIEW: 'about-view'
            },
            mounted() {
                this.isAuthenticated = '@Model.IsAuthenticated' === 'True' ? true : false;

                if (this.isAuthenticated) {
                    this.showMap();
                } else {
                    this.showMap();
                }
            },
            methods: {
                showMap: function () {
                    this.selectedView = this.MAP_VIEW;
                }
            }
        });
    </script>
}